import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// Conversion rates (approximate)
const USD_TO_EUR = 0.92;
const USD_TO_PLN = 4.0;

// P150 Max prices in USD from raptordynamic.com
const prices: Record<string, number> = {
  // Fuselage Front Compartment Frame
  '02-001-11140': 80.00,
  '14-007-00034': 91.66,
  '02-001-11502': 5.13,
  '14-006-00049': 27.13,
  '02-001-12041': 5.13,
  '02-001-10796': 3.00,
  '05-002-02069': 7.33,
  '02-001-11010': 6.96,
  '02-001-11016': 8.80,
  '14-006-00044': 4.76,
  '02-001-08857': 1.46,
  '02-001-10871': 1.46,
  '02-001-10954': 1.47,
  '02-001-10861': 1.46,
  '14-007-00024': 3.33,

  // Power System - Front Compartment
  '05-002-02094': 634.33,
  '01-027-02826': 47.30,
  '05-002-02291': 338.80,
  '02-001-11012': 1.46,
  '01-027-02864': 49.14,
  '02-001-11013': 1.46,
  '02-002-13256': 12.83,
  '02-001-10870': 2.56,
  '02-002-14279': 41.44,
  '01-027-02863': 29.34,

  // Arm Frame
  '05-002-02051': 19.91,
  '02-001-10854': 38.24,
  '02-001-10855': 2.56,

  // FC and Sensing System
  '14-007-00174': 363.00,
  '14-007-00025': 502.33,
  '01-027-02861': 23.46,
  '14-007-00101': 204.60,
  '14-007-00009': 11.00,
  '05-002-02304': 2399.10,
  '01-027-02862': 25.66,
  '14-007-00010': 8.80,
  '14-007-00007': 60.86,
  '05-002-02194': 2713.33,
  '01-027-02830': 22.00,
  '01-027-02829': 20.53,

  // Fuselage Power System
  '14-007-00022': 33.73,
  '02-001-11028': 8.06,
  '02-001-11193': 11.00,
  '02-001-11192': 3.36,
  '02-002-13612': 8.06,
  '02-002-13613': 12.10,
  '02-001-10739': 3.30,
  '01-027-02865': 31.53,
  '01-027-02780': 35.20,

  // Antennas
  '01-003-00411': 15.00,
  '14-007-00018': 15.00,
  '01-003-00410': 15.00,
  '14-007-00021': 15.00,
  '01-003-00412': 15.00,

  // Revospray/Revocast System
  '14-007-00019': 5.00,
  '14-007-00017': 5.00,
  '01-027-02867': 33.00,

  // RealTerra
  '14-007-00116': 41.80,
  '02-002-13943': 17.33,
  '02-002-14300': 26.40,
  '14-007-00046': 24.20,
  '14-007-00047': 24.20,
  '05-002-02213': 1408.00,
  '02-002-14301': 18.10,

  // Revospray System
  '02-002-13935': 10.00,
  '02-001-11098': 5.00,
  '02-001-11273': 3.30,

  // Revospray Mainbody
  '02-001-11744': 35.20,
  '05-002-02066': 90.20,
  '14-007-00050': 155.83,
  '02-001-10417': 1.10,
  '02-001-10886': 1.46,
  '02-001-11024': 198.00,
  '14-007-00074': 14.30,
  '14-007-00051': 28.60,
  '14-007-00039': 5.13,
  '02-001-10996': 5.86,
  '02-002-13680': 3.66,
  '14-007-00052': 9.54,
  '14-007-00016': 3.66,
  '02-001-11201': 5.86,
  '14-007-00040': 5.86,
  '05-002-02210': 158.76,
  '01-027-02868': 27.86,

  // Nozzle System
  '02-001-09892': 10.00,
  '01-027-02866': 15.00,
  '05-002-02065': 50.00,
  '14-007-00023': 10.00,
  '14-007-00133': 30.00,
  '14-007-00098': 80.00,
  '14-007-00013': 5.00,
  '14-007-00012': 5.00,

  // RevoCast
  '14-007-00076': 20.00,
  '02-002-09459': 5.00,
  '01-027-02869': 15.00,
  '02-001-07784': 2.00,
  '14-007-00090': 15.00,
  '02-001-10505': 3.00,
  '02-002-14441': 10.00,
  '02-002-14111': 5.00,
  '02-001-10540': 2.56,
  '02-002-14194': 1.46,
  '02-001-10529': 1.47,
  '02-001-10407': 5.86,
  '02-002-14198': 7.33,
  '02-001-10385': 3.30,
};

async function main() {
  console.log('Updating P150 Max prices...\n');

  let updated = 0;
  let notFound = 0;

  for (const [sku, priceUSD] of Object.entries(prices)) {
    const pricePLN = Math.round(priceUSD * USD_TO_PLN * 100); // in grosz (cents)
    const priceEUR = Math.round(priceUSD * USD_TO_EUR * 100); // in cents

    const product = await prisma.product.findFirst({
      where: { sku, category: 'P150 Max' }
    });

    if (product) {
      await prisma.product.update({
        where: { id: product.id },
        data: {
          price: pricePLN,
          priceEUR: priceEUR,
        }
      });
      console.log(`Updated ${sku}: ${(pricePLN / 100).toFixed(2)} PLN / ${(priceEUR / 100).toFixed(2)} EUR`);
      updated++;
    } else {
      console.log(`Not found: ${sku}`);
      notFound++;
    }
  }

  console.log(`\nDone! Updated: ${updated}, Not found: ${notFound}`);
}

main()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
